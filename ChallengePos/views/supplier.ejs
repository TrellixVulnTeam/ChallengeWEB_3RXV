<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Soppeng Admin</title>
  <!-- plugins:css -->
  <link rel="stylesheet" href="../public/assets/vendors/mdi/css/materialdesignicons.min.css">
  <link rel="stylesheet" href="../public/assets/vendors/css/vendor.bundle.base.css">
  <!-- endinject -->
  <!-- Plugin css for this page -->
  <link rel="stylesheet" href="../public/assets/vendors/select2/select2.min.css">
  <link rel="stylesheet" href="../public/assets/vendors/select2-bootstrap-theme/select2-bootstrap.min.css">
  <!-- End plugin css for this page -->
  <!-- inject:css -->
  <!-- endinject -->
  <!-- Layout styles -->
  <link rel="stylesheet" href="../public/assets/css/style.css">
  <!-- End layout styles -->
  <link rel="shortcut icon" href="../public/assets/images/logo.png" />

  <style>
    input:disabled {
      color: black;
    }
  </style>

</head>

<body>

  <div class="container-scroller">

    <!-- Nav bar -->
    <nav class="navbar p-0 fixed-top d-flex flex-row">
      <div class="navbar-brand-wrapper d-flex d-lg-none align-items-center justify-content-center">
        <a class="navbar-brand brand-logo-mini" href="/utama"><img src="assets/images/sii.png" alt="logo" /></a>
      </div>
      <div class="navbar-menu-wrapper flex-grow d-flex align-items-stretch">
        <button class="navbar-toggler navbar-toggler align-self-center" type="button" data-toggle="minimize">
          <span class="mdi mdi-menu"></span>
        </button>
        <ul class="navbar-nav navbar-nav-right">
          <li class="nav-item dropdown d-none d-lg-block">
            <a class="nav-link btn btn-success create-new-button" id="createbuttonDropdown" data-toggle="dropdown"
              aria-expanded="false" href="#">Kasir</a>
            <div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list"
              aria-labelledby="createbuttonDropdown">
              <a class="dropdown-item preview-item" href="/penjualan">
                <div class="preview-thumbnail">
                  <div class="preview-icon bg-dark rounded-circle">
                    <i class="mdi mdi-laptop"></i>
                  </div>
                </div>
                <div class="preview-item-content">
                  <p class="preview-subject ellipsis mb-1">Penjualan</p>
                </div>
              </a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item preview-item" href="/pembelian">
                <div class="preview-thumbnail">
                  <div class="preview-icon bg-dark rounded-circle">
                    <i class="mdi mdi-briefcase-download"></i>
                  </div>
                </div>
                <div class="preview-item-content">
                  <p class="preview-subject ellipsis mb-1">Pembelian</p>
                </div>
              </a>
            </div>
          </li>
          <li class="nav-item dropdown border-left">
            <a class="nav-link count-indicator dropdown-toggle" id="messageDropdown" href="#" data-toggle="dropdown"
              aria-expanded="false">
              <i class="mdi mdi-email"></i>
              <span class="count bg-success"></span>
            </a>
            <div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list"
              aria-labelledby="messageDropdown">
              <h6 class="p-3 mb-0">Messages</h6>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item preview-item">
                <div class="preview-thumbnail">
                  <img src="assets/images/faces/face4.jpg" alt="image" class="rounded-circle profile-pic">
                </div>
                <div class="preview-item-content">
                  <p class="preview-subject ellipsis mb-1">Mark send you a message</p>
                  <p class="text-muted mb-0"> 1 Minutes ago </p>
                </div>
              </a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item preview-item">
                <div class="preview-thumbnail">
                  <img src="assets/images/faces/face2.jpg" alt="image" class="rounded-circle profile-pic">
                </div>
                <div class="preview-item-content">
                  <p class="preview-subject ellipsis mb-1">Cregh send you a message</p>
                  <p class="text-muted mb-0"> 15 Minutes ago </p>
                </div>
              </a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item preview-item">
                <div class="preview-thumbnail">
                  <img src="assets/images/faces/face3.jpg" alt="image" class="rounded-circle profile-pic">
                </div>
                <div class="preview-item-content">
                  <p class="preview-subject ellipsis mb-1">Profile picture updated</p>
                  <p class="text-muted mb-0"> 18 Minutes ago </p>
                </div>
              </a>
              <div class="dropdown-divider"></div>
              <p class="p-3 mb-0 text-center">4 new messages</p>
            </div>
          </li>
          <li class="nav-item dropdown border-left">
            <a class="nav-link count-indicator dropdown-toggle" id="notificationDropdown" href="#"
              data-toggle="dropdown">
              <i class="mdi mdi-bell"></i>
              <span class="count bg-danger"></span>
            </a>
            <div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list"
              aria-labelledby="notificationDropdown">
              <h6 class="p-3 mb-0">Notifications</h6>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item preview-item">
                <div class="preview-thumbnail">
                  <div class="preview-icon bg-dark rounded-circle">
                    <i class="mdi mdi-calendar text-success"></i>
                  </div>
                </div>
                <div class="preview-item-content">
                  <p class="preview-subject mb-1">Event today</p>
                  <p class="text-muted ellipsis mb-0"> Just a reminder that you have an event today </p>
                </div>
              </a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item preview-item">
                <div class="preview-thumbnail">
                  <div class="preview-icon bg-dark rounded-circle">
                    <i class="mdi mdi-settings text-danger"></i>
                  </div>
                </div>
                <div class="preview-item-content">
                  <p class="preview-subject mb-1">Settings</p>
                  <p class="text-muted ellipsis mb-0"> Update dashboard </p>
                </div>
              </a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item preview-item">
                <div class="preview-thumbnail">
                  <div class="preview-icon bg-dark rounded-circle">
                    <i class="mdi mdi-link-variant text-warning"></i>
                  </div>
                </div>
                <div class="preview-item-content">
                  <p class="preview-subject mb-1">Launch Admin</p>
                  <p class="text-muted ellipsis mb-0"> New admin wow! </p>
                </div>
              </a>
              <div class="dropdown-divider"></div>
              <p class="p-3 mb-0 text-center">See all notifications</p>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link" id="profileDropdown" href="#" data-toggle="dropdown">
              <div class="navbar-profile">
                <img class="img-xs rounded-circle" src="assets/images/faces/face15.jpg" alt="">
                <p class="mb-0 d-none d-sm-block navbar-profile-name">
                  <%= user.name %>
                </p>
                <i class="mdi mdi-menu-down d-none d-sm-block"></i>
              </div>
            </a>
            <div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list"
              aria-labelledby="profileDropdown">
              <h6 class="p-3 mb-0">Profile</h6>
              <div class="dropdown-divider"></div>
              <a href="/logout" class="dropdown-item preview-item">
                <div class="preview-thumbnail">
                  <div class="preview-icon bg-dark rounded-circle">
                    <i class="mdi mdi-logout text-danger"></i>
                  </div>
                </div>
                <div class="preview-item-content">
                  <p class="preview-subject mb-1">Log out</p>
                </div>
              </a>
            </div>
          </li>
        </ul>
        <button class="navbar-toggler navbar-toggler-right d-lg-none align-self-center" type="button"
          data-toggle="offcanvas">
          <span class="mdi mdi-format-line-spacing"></span>
        </button>
      </div>
    </nav>

    <!-- Side Bar -->
    <nav class="sidebar sidebar-offcanvas" id="sidebar">
      <div class="sidebar-brand-wrapper d-none d-lg-flex align-items-center justify-content-center fixed-top">
        <a class="sidebar-brand brand-logo" href="/utama"><img src="assets/images/sii.png" alt="logo" /></a>
        <a class="sidebar-brand brand-logo-mini" href="/utama"><img src="assets/images/blue.png" alt="logo" /></a>
      </div>
      <ul class="nav">
        <li class="nav-item profile">
          <div class="profile-desc">
            <div class="profile-pic">
              <div class="count-indicator">
                <img class="img-xs rounded-circle " src="assets/images/faces/face15.jpg" alt="">
                <span class="count bg-success"></span>
              </div>
              <div class="profile-name">
                <h5 class="mb-0 font-weight-normal">
                  <%= user.name %>
                </h5>
                <span>
                  <%= user.role %>
                </span>
              </div>
            </div>
            <a href="#" id="profile-dropdown" data-toggle="dropdown"><i class="mdi mdi-dots-vertical"></i></a>
            <div class="dropdown-menu dropdown-menu-right sidebar-dropdown preview-list"
              aria-labelledby="profile-dropdown">
              <a href="#" class="dropdown-item preview-item">
                <div class="preview-thumbnail">
                  <div class="preview-icon bg-dark rounded-circle">
                    <i class="mdi mdi-settings text-primary"></i>
                  </div>
                </div>
                <div class="preview-item-content">
                  <p class="preview-subject ellipsis mb-1 text-small">Account settings</p>
                </div>
              </a>
              <div class="dropdown-divider"></div>
              <a href="#" class="dropdown-item preview-item">
                <div class="preview-thumbnail">
                  <div class="preview-icon bg-dark rounded-circle">
                    <i class="mdi mdi-onepassword  text-info"></i>
                  </div>
                </div>
                <div class="preview-item-content">
                  <p class="preview-subject ellipsis mb-1 text-small">Change Password</p>
                </div>
              </a>
              <div class="dropdown-divider"></div>
              <a href="#" class="dropdown-item preview-item">
                <div class="preview-thumbnail">
                  <div class="preview-icon bg-dark rounded-circle">
                    <i class="mdi mdi-calendar-today text-success"></i>
                  </div>
                </div>
                <div class="preview-item-content">
                  <p class="preview-subject ellipsis mb-1 text-small">To-do list</p>
                </div>
              </a>
            </div>
          </div>
        </li>
        <li class="nav-item nav-category">
          <span class="nav-link">Navigation</span>
        </li>
        <li class="nav-item menu-items">
          <a class="nav-link" href="/utama">
            <span class="menu-icon">
              <i class="mdi mdi-speedometer"></i>
            </span>
            <span class="menu-title">Dashboard</span>
          </a>
        </li>
        <li class="nav-item menu-items">
          <a class="nav-link" href="/barang">
            <span class="menu-icon">
              <i class="mdi mdi-archive"></i>
            </span>
            <span class="menu-title">Barang</span>
          </a>
        <li class="nav-item menu-items">
          <a class="nav-link" href="/gudang">
            <span class="menu-icon">
              <i class="mdi mdi-apps"></i>
            </span>
            <span class="menu-title">Gudang</span>
          </a>
        </li>
        <li class="nav-item menu-items">
          <a class="nav-link" href="/satuan">
            <span class="menu-icon">
              <i class="mdi mdi-basket-fill"></i>
            </span>
            <span class="menu-title">Satuan</span>
          </a>
        </li>
        <li class="nav-item menu-items">
          <a class="nav-link" href="/supplier">
            <span class="menu-icon">
              <i class="mdi mdi-account-multiple"></i>
            </span>
            <span class="menu-title">Supplier</span>
          </a>
        </li>
        <li class="nav-item menu-items">
          <a class="nav-link" href="/varian">
            <span class="menu-icon">
              <i class="mdi mdi-code-equal"></i>
            </span>
            <span class="menu-title">Varian</span>
          </a>
        </li>
      </ul>
    </nav>

    <div class="main-panel">
      <div class="content-wrapper">
        <div class="row">
          <!-- form tambah -->
          <div class="col-md-6 grid-margin stretch-card">
            <div class="card">
              <div class="card-body">
                <h4 class="card-title">Tambah Supplier Barang</h4>
                <form class="forms-sample" id="form-tambah">
                  <input type="hidden" id="id_supplier" name="id" value="">
                  <div class="form-group">
                    <label for="nama_supplier">Nama Supplier</label>
                    <input type="text" class="form-control" id="nama_supplier" placeholder="Nama Supplier">
                  </div>
                  <div class="form-group">
                    <label for="nomor_hp">Nomor HP</label>
                    <input type="tel" class="form-control" id="nomor_hp" pattern="[0-9]{4}-[0-9]{4}-[0-9]{4}"
                      placeholder="08xx-xxxx-xxxx">
                  </div>
                  <div class="form-group">
                    <label for="alamat_Supplier">Alamat Supplier</label>
                    <textarea class="form-control" id="alamat_supplier" rows="4"></textarea>
                  </div>
                  <button type="submit" class="btn btn-primary mr-2">Submit</button>
                  <button type="button" id="reset-form-tambah" class="btn btn-dark">Cancel</button>
                </form>
              </div>
            </div>
          </div>
          <!-- form edit -->
          <div class="col-md-6 grid-margin stretch-card">
            <div class="card">
              <div class="card-body">
                <h4 class="card-title">Edit Supplier Barang</h4>
                <form class="forms-sample" id="form-edit">
                  <div class="form-group">
                    <label for="id_supplieredit">ID Supplier</label>
                    <input type="text" class="form-control" id="id_supplieredit" name="id" disabled>
                  </div>
                  <div class="form-group">
                    <label for="nama_supplieredit">Nama Supplier</label>
                    <input type="text" class="form-control" id="nama_supplieredit" placeholder="Nama Supplier">
                  </div>
                  <div class="form-group">
                    <label for="nomor_hp">Nomor HP</label>
                    <input type="tel" class="form-control" id="nomor_hpedit" pattern="[0-9]{4}-[0-9]{4}-[0-9]{4}"
                      placeholder="08xx-xxxx-xxxx">
                  </div>
                  <div class="form-group">
                    <label for="alamat_Supplier">Alamat Supplier</label>
                    <textarea class="form-control" id="alamat_supplieredit" rows="4"></textarea>
                  </div>
                  <button type="submit" class="btn btn-primary mr-2">Submit</button>
                  <button type="button" id="reset-form-edit" class="btn btn-dark">Cancel</button>
                </form>
              </div>
            </div>
          </div>

          <!-- table -->
          <div class="col-md-12 grid-margin stretch-card">
            <div class="card">
              <div class="card-body">
                <h4 class="card-title">Daftar Supplier</h4>
                <div class="table-responsive">
                  <table class="table table-striped">
                    <thead>
                      <tr>
                        <th> ID Supplier </th>
                        <th> Nama Supplier</th>
                        <th> Nomor HP Supplier</th>
                        <th> E-mail Supplier</th>
                        <th> Alamat Supplier</th>
                      </tr>
                    </thead>
                    <tbody>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>



</body>

<script src="../public/assets/vendors/js/vendor.bundle.base.js"></script>
<!-- endinject -->
<!-- Plugin js for this page -->
<script src="../public/assets/vendors/select2/select2.min.js"></script>
<script src="../public/assets/vendors/typeahead.js/typeahead.bundle.min.js"></script>
<!-- End plugin js for this page -->
<!-- inject:js -->
<script src="../public/assets/js/off-canvas.js"></script>
<script src="../public/assets/js/hoverable-collapse.js"></script>
<script src="../public/assets/js/misc.js"></script>
<script src="../public/assets/js/settings.js"></script>
<script src="../public/assets/js/todolist.js"></script>
<!-- endinject -->
<!-- Custom js for this page -->
<script src="../public/assets/js/file-upload.js"></script>
<script src="../public/assets/js/typeahead.js"></script>
<script src="../public/assets/js/select2.js"></script>
<!-- End custom js for this page -->

<script>
  const readData = () => {
    $.ajax({
      method: "GET",
      url: "http://localhost:3001/supplier",
      dataType: "json",
      headers: {
        json: true
      }
    }).done(function (data) {

      let html = ''
      data.forEach((item, index) => {
        html += `
        <tr>
          <td>${item.id_supplier}</td>
          <td>${item.nama}</td>
          <td>${item.alamat}</td>
          <td>${item.telp}</td>
          <td>
            <button type="button" class="btn btn-success btn-icon-text" id_data="${item.id_supplier}"><i class="mdi mdi-file-check btn-icon-append"></i></button>
            <button type="button" class="btn btn-danger btn-icon-delete" id_data="${item.id_supplier}"><i class="mdi mdi-trash-can btn-icon-append"></i></button>
          </td>
        </tr>
        `
      });
      $('table tbody').html(html)
    }).fail(function (err) {
      console.log("error", err)
      alert('gagal jquery')
    })
  }

  const saveData = (id_supplier, nomor_hp, nama_supplier, alamat_supplier) => {
    $.ajax({
      method: "POST",
      url: `http://localhost:3001/supplier`,
      dataType: "json",
      headers: {
        json: true
      },
      data: { nomor_hp, nama_supplier, alamat_supplier }
    }).done(function (response) {
      readData()
      $("#form-tambah").trigger("reset");
    }).fail(function (err) {
      alert('gagal pake jquery save')
    })
  }
  const saveEdit = (id_supplier, nama_supplier, alamat_supplier, nomor_hp) => {
    $.ajax({
      method: "PUT",
      url: `http://localhost:3001/supplier/${id_supplier}`,
      dataType: "json",
      headers: {
        json: true
      },
      data: { nama_supplier, alamat_supplier, nomor_hp }
    }).done(function (response) {
      readData()
      $('#id_supplieredit').val('')
      $("#form-edit").trigger("reset");
    }).fail(function (err) {
      alert('gagal pake jquery save edit')
    })
  }

  const editData = (id) => {
    $.ajax({
      method: "GET",
      url: `http://localhost:3001/supplier/${id}`,
      dataType: "json",
      headers: {
        json: true
      }
    }).done(function (data) {
      console.log(data)
      $('#id_supplieredit').val(data[0].id_supplier)
      $('#nama_supplieredit').val(data[0].nama)
      $('#alamat_supplieredit').val(data[0].alamat)
      $('#nomor_hpedit').val(data[0].telp)
    }).fail(function (err) {
      alert('gagal pake jquery')
    })
  }

  const deleteData = (id) => {
    $.ajax({
      method: "DELETE",
      url: `http://localhost:3001/supplier/${id}`,
      dataType: "json",
      headers: {
        json: true
      }

    }).done(function (response) {
      readData()
    }).fail(function (err) {
      alert('gagal pake jquery')
    })
  }

  $(document).ready(function () {
    readData()

    $('#form-tambah').submit(function (event) {
      event.preventDefault();
      const id_supplier = $('#id_supplier').val()
      const nomor_hp = $('#nomor_hp').val()
      const nama_supplier = $('#nama_supplier').val()
      const alamat_supplier = $('#alamat_supplier').val()
      saveData(id_supplier, nomor_hp, nama_supplier, alamat_supplier)
    })

    $('#form-edit').submit(function (event) {
      event.preventDefault();
      const id_supplier = $('#id_supplieredit').val()
      const nama_supplier = $('#nama_supplieredit').val()
      const alamat_supplier = $('#alamat_supplieredit').val()
      const nomor_hp = $('#nomor_hpedit').val()
      saveEdit(id_supplier, nama_supplier, alamat_supplier, nomor_hp)
    })

    $('table tbody').on('click', '.btn-icon-text', function () {
      const id = $(this).attr('id_data')
      editData(id)

    })

    $('table tbody').on('click', '.btn-icon-delete', function () {
      const id = $(this).attr('id_data')
      deleteData(id)
    })

    $('#reset-form-tambah').click(function () {
      $("#form-tambah").trigger("reset");
      readData()
    })

    $('#reset-form-edit').click(function () {
      $("#form-edit").trigger("reset");
      readData()
    })


  })
</script>

</html>